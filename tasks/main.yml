---
- name: Ensure that the auter package is installed
  tags: auter
  become: true
  yum:
    enablerepo: epel
    name: auter
    state: present
  register: auter_yum

- block:
    - name: Applying auter.conf configurations
      template:
        src: auter.conf.j2
        dest: /etc/auter/auter.conf
        owner: root
        group: root
        mode: 0644

    - name: Executing auter cronjob tasks
      import_tasks: auter_cronjobs.yml
      when:
        - auter_cronjobs is defined
        - auter_cronjobs|length > 0

    - name: Executing auter scripts tasks
      import_tasks: auter_scripts.yml
      when:
        - auter_scripts is defined
        - auter_scripts|length > 0

    - name: Enabling the auter service
      command: |
        /bin/auter --enable
  tags: auter
  become: true
  when: auter_yum|success
...
